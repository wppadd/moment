<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Moment</title>
  <meta name="author" content="weishai">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
  <meta name="format-detection" content="telephone=no" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <link rel="stylesheet" href="css/font-moment/font.css" />
  <link rel="stylesheet" href="css/app.css" />
</head>
<body>
<div class="wrap">
  <div class="logo">
    <div class="logo-body"></div>
    <div class="logo-trigon">
      <div class="logo-part-top"></div>
      <div class="logo-part-left"></div>
      <div class="logo-part-right"></div>
    </div>
    <div class="logo-halo"></div>
    <div class="logo-cover-wrap">
      <div class="logo-cover">
        <div class="logo-jet"></div>
      </div>
    </div>
    <div class="logo-showend">
      <div class="logo-tent">
        <div class="logo-textbg">
          <div class="logo-text">
            <p>M</p>
            <p class="tips">按住屏幕查看图片</p>
          </div>
        </div>
      </div>
      <div class="logo-img">
        <img id="picSnap" data-src="http://apps.wppadd.com/moment/img/test.jpg" alt="">
        <div class="logo-glass"></div>
      </div>
      <div class="logo-mask"></div>
    </div>
    <div class="logo-upload"><i class="icon-camera"></i></div>
  </div>
</div>
<script src="js/jquery/jquery.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
  var isHidePic = false
    , isReadyShowPic = false

  $(function () {
    $('img').each(function (e) {
      var curImgUrl = $(this).data('src')
      var img = new Image()
      img.src = curImgUrl

      $(this).attr('src', curImgUrl)
    })
  })

  window.onload = function () {
    demoRun()
  }

  function demoRun () {
    $('.logo').addClass('logo-loading logo-loading-img')
      .delay(2400).queue(function (next) {
        $(this).addClass('logo-loadingend')
        isReadyShowPic = true
        next()
      })
      // .delay(1600).queue(function (next) {
      //   $(this).addClass('logo-showimg')
      //   next()
      // })
      // .delay(2000).queue(function (next) {
      //   $(this).removeClass('logo-loadingend logo-loading logo-loading-img')
      //   next()
      // })
      // .delay(3000).queue(function (next) {
      //   $(this).addClass('logo-next')
      //   next()
      // })
      // .delay(2200).queue(function (next) {
      //   $(this).removeClass('logo-next logo-showimg')
      //     .addClass('logo-loading logo-loading-img')
      //   next()
      // })
      // .delay(2400).queue(function (next) {
      //   $(this).find('.logo-text').css('top', '20%').html('敬请期待')
      //   $(this).addClass('logo-loadingend')
      //   next()
      // })



    $('body').one('touchstart', function(e) {
      if(!isReadyShowPic){
        return
      }
      console.log('touchstart')
      showPic(3000)
      $(this).one('touchend', function (et) {
        hidePic()
        et.preventDefault()
      })
      e.preventDefault()
    })
  }

  function showPic(time) {
    $('.logo').addClass('logo-showimg')
      .delay(500).queue(function (next) {
        $(this).removeClass('logo-loadingend logo-loading logo-loading-img')
        next()
      })
      .delay(time).queue(function (next) {
        hidePic()
        next()
      })
  }

  function hidePic() {
    if(isHidePic){
      return
    }
    $('#picSnap').remove()
    isHidePic = true
    $('.logo').addClass('logo-next')
      .delay(100).queue(function (next) {
        $(this).removeClass('logo-next logo-showimg')
          .addClass('logo-loading')
          next()
      })
      .delay(3000).queue(function (next) {
        $(this).addClass('logo-start')
        next()
      })
  }

</script>
</body>
</html>